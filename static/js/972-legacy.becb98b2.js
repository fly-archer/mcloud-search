(self["webpackChunkmcloud_search"]=self["webpackChunkmcloud_search"]||[]).push([[972],{58972:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return v}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isInternalBrowser?n("van-nav-bar",{attrs:{title:"数据展示","left-arrow":""},on:{"click-left":t.onClickLeft}}):t._e(),n("div",{staticClass:"app-container"},[n("div",{staticClass:"auto-resfresh"},[n("a-switch",{attrs:{"checked-children":"自动刷新","un-checked-children":"自动刷新"},on:{change:t.onSwitchChange},model:{value:t.isRun,callback:function(e){t.isRun=e},expression:"isRun"}}),n("div",{staticClass:"copy-url",on:{click:t.onCopyUrl}},[n("van-icon",{attrs:{color:"#1890ff",name:"records"}}),n("span",[t._v("复制链接")])],1)],1),n("van-row",[n("van-col",{attrs:{span:"12"}},[t._v("设备SN: "+t._s(t.params.sn))]),n("van-col",{attrs:{span:"12"}},[t._v(" 数据范围: "+t._s(t.formatDataType())+" ")])],1),n("van-row",[n("van-col",[t._v(" 时间范围:"+t._s(t.params.begin+"~"+t.params.end)+" ")])],1),n("van-row",[n("van-col",[t._v(" 内容过滤: "+t._s(t.params.filterValue||"---")+" ")])],1),n("van-row",[n("van-col",[t._v(" 数据总数: "+t._s("iot"==t.active?t.iotTotalCount+" (已加载"+t.iotResultList.length+"条)":t.mdnetTotalCount+" (已加载"+t.mdnetResultList.length+"条)")+" ")])],1),n("van-row",{ref:"tabsContainer"},[n("van-tabs",{attrs:{sticky:!0,color:"#1890ff",animated:"",swipeable:""},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},["0"==t.params.iotData||"1"==t.params.iotData?n("van-tab",{attrs:{title:"物联网平台",name:"iot"}},[n("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.iotRefreshing,callback:function(e){t.iotRefreshing=e},expression:"iotRefreshing"}},[t.iotFinished&&0==t.iotResultList.length?n("van-empty",{attrs:{description:"暂无数据"}}):t._e(),n("van-list",{attrs:{finished:t.iotFinished,error:t.iotError,"error-text":"请求失败，点击重新加载","finished-text":t.iotResultList.length>0?"没有更多了":""},on:{"update:error":function(e){t.iotError=e},load:t.onIotLoad},model:{value:t.iotLoading,callback:function(e){t.iotLoading=e},expression:"iotLoading"}},t._l(t.iotResultList,(function(e,a){return n("van-cell",{key:a,attrs:{center:"","is-link":""},on:{click:function(n){return t.onCellClick(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"custom-title"},[n("span",{staticClass:"num"},[t._v(t._s(a+1))]),n("span",{staticClass:"title"},[t._v(" "+t._s(e.content.replace(/\s*/g,""))+" ")])])]},proxy:!0},{key:"label",fn:function(){return[n("div",{staticClass:"custom-label"},[n("span",[t._v(t._s(e.timeStr))]),n("span",[t._v("数据类型 "+t._s(e.dataType))])])]},proxy:!0}],null,!0)})})),1)],1)],1):t._e(),"0"==t.params.iotData||"2"==t.params.iotData?n("van-tab",{attrs:{name:"mdnet",title:"MDNET平台"}},[n("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.mdnetRefreshing,callback:function(e){t.mdnetRefreshing=e},expression:"mdnetRefreshing"}},[t.mdnetFinished&&0==t.mdnetResultList.length?n("van-empty",{attrs:{description:"暂无数据"}}):t._e(),n("van-list",{attrs:{finished:t.mdnetFinished,error:t.mdnetError,"error-text":"请求失败，点击重新加载","finished-text":t.mdnetResultList.length>0?"没有更多了":""},on:{"update:error":function(e){t.mdnetError=e},load:t.onMdnetLoad},model:{value:t.mdnetLoading,callback:function(e){t.mdnetLoading=e},expression:"mdnetLoading"}},t._l(t.mdnetResultList,(function(e,a){return n("van-cell",{key:a,attrs:{center:"","is-link":""},on:{click:function(n){return t.onCellClick(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"custom-title"},[n("span",{staticClass:"num"},[t._v(t._s(a+1))]),n("span",{staticClass:"title"},[t._v(" "+t._s(e.content.replace(/\s*/g,""))+" ")])])]},proxy:!0},{key:"label",fn:function(){return[n("div",{staticClass:"custom-label"},[n("span",[t._v(t._s(e.timeStr))]),n("span",[t._v("数据类型 "+t._s(e.dataType))])])]},proxy:!0}],null,!0)})})),1)],1)],1):t._e()],1)],1)],1)],1)},s=[],r=n(23748);function i(t){if(Array.isArray(t))return(0,r.Z)(t)}n(82526),n(41817),n(41539),n(32165),n(78783),n(33948),n(91038);function o(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var c=n(48936);n(21703),n(96647);function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t){return i(t)||o(t)||(0,c.Z)(t)||l()}n(5212),n(40561);var d=n(79663),h={name:"MobileDetail",data:function(){return{value:"",show:!1,active:"",params:{},searchRecords:this.$ls.get("searchRecords")||[],isInternalBrowser:this.$ls.get("isInternalBrowser"),time:null,timerRun:null,isRun:!1,tabsContainer:null,resultListLength:0,iotTotalCount:"",iotResultList:[],iotCurrentPage:1,iotLoading:!1,iotFinished:!1,iotRefreshing:!1,iotError:!1,mdnetTotalCount:"",mdnetResultList:[],mdnetCurrentPage:1,mdnetLoading:!1,mdnetFinished:!1,mdnetRefreshing:!1,mdnetError:!1}},mounted:function(){this.tabsContainer=this.$refs.tabsContainer,this.params=Object.assign({},this.params,this.$route.query)},methods:{onClickLeft:function(){this.$router.push("/mobile/home")},onIotLoad:function(){var t=this,e=Object.assign({},this.params,{currentPage:this.iotCurrentPage,pageSize:20,iotData:!0});delete e.fastTime,(0,d.A)(e).then((function(n){if(n.success){var a;if(t.iotTotalCount=n.data.totalCount,0!==n.data.totalCount)(a=t.iotResultList).push.apply(a,u(n.data.currentPageData));else t.iotFinished=!0;1==t.iotCurrentPage&&(t.searchRecords.some((function(n,a){n.sn===e.sn&&t.searchRecords.splice(a,1)})),t.searchRecords.length>=20&&t.searchRecords.pop(),t.searchRecords.unshift(t.params),t.$ls.set("searchRecords",t.searchRecords)),t.iotCurrentPage<n.data.totalPage?t.iotCurrentPage++:t.iotCurrentPage==n.data.totalPage&&(t.iotFinished=!0)}else t.iotError=!0;t.iotRefreshing=!1,t.iotLoading=!1}))},onMdnetLoad:function(){var t=this,e=Object.assign({},this.params,{currentPage:this.mdnetCurrentPage,pageSize:20,iotData:!1});delete e.fastTime,(0,d.A)(e).then((function(n){if(n.success){var a;if(t.mdnetTotalCount=n.data.totalCount,0!==n.data.totalCount)(a=t.mdnetResultList).push.apply(a,u(n.data.currentPageData));else t.mdnetFinished=!0;1==t.mdnetCurrentPage&&(t.searchRecords.some((function(n,a){n.sn===e.sn&&t.searchRecords.splice(a,1)})),t.searchRecords.length>=20&&t.searchRecords.pop(),t.searchRecords.unshift(t.params),t.$ls.set("searchRecords",t.searchRecords)),t.mdnetCurrentPage<n.data.totalPage?t.mdnetCurrentPage++:t.mdnetCurrentPage==n.data.totalPage&&(t.mdnetFinished=!0)}else t.mdnetError=!0;t.mdnetRefreshing=!1,t.mdnetLoading=!1}))},onCellClick:function(t){this.$router.push({name:"mobile/jsonDetail",query:t})},formatDataType:function(){var t;return t="0"==this.params.dataType?"传感器数据":"1"==this.params.dataType?"设备状态数据":"全部数据",t},onRefresh:function(){"mdnet"!=this.active?(this.iotRefreshing=!0,this.iotFinished=!1,this.iotLoading=!0,this.iotCurrentPage=1,this.iotResultList=[],this.onIotLoad()):(this.mdnetRefreshing=!0,this.mdnetFinished=!1,this.mdnetLoading=!0,this.mdnetCurrentPage=1,this.mdnetResultList=[],this.onMdnetLoad())},timerRefreshPage:function(){-1==this.time&&(this.time=20,this.onRefresh()),this.time--},timerEvent:function(){this.time=20,this.onRefresh(),this.isRun=!0,this.timerRun=setInterval(this.timerRefreshPage,1e3)},stopTimerEvent:function(){this.timerRun&&(clearInterval(this.timerRun),this.isRun=!1)},onCopyUrl:function(){var t=window.location.href,e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("Copy"),document.body.removeChild(e),this.$notify({type:"success",message:"复制成功"})},onSwitchChange:function(t){t?(this.stopTimerEvent(),this.timerEvent()):this.stopTimerEvent()}}},m=h,f=n(1001),p=(0,f.Z)(m,a,s,!1,null,"02f9fabc",null),v=p.exports},79663:function(t,e,n){"use strict";n.d(e,{A:function(){return o}});var a=n(67906),s=n(16198),r=n(91026),i=n(25972);function o(t){return c.apply(this,arguments)}function c(){return c=(0,s.Z)((0,a.Z)().mark((function t(e){return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,i.WY)(r.QUERY_CLOUD_DATA,i.Yw.POST,e));case 1:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}},91026:function(t){var e="https://chaxunapi.shmedo.cn";t.exports={QUERY_CLOUD_DATA:"".concat(e,"/queryCloudData")}},23748:function(t,e,n){"use strict";function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}n.d(e,{Z:function(){return a}})},48936:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});n(47042),n(41539),n(68309),n(91038),n(78783),n(74916),n(77601);var a=n(23748);function s(t,e){if(t){if("string"===typeof t)return(0,a.Z)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,a.Z)(t,e):void 0}}}}]);